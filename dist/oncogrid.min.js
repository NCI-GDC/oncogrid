!function t(e,r,o){function n(a,s){if(!r[a]){if(!e[a]){var d="function"==typeof require&&require;if(!s&&d)return d(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return n(r?r:t)},l,l.exports,t,e,r,o)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)n(o[a]);return n}({1:[function(t,e,r){"use strict";var o;o=function(t,e,r){var o=this;o.prefix=t.prefix||"og-",o.observations=t.observations,o.svg=e,o.rotated=r||!1,o.domain=(o.rotated?t.genes:t.donors)||[],o.margin=t.margin||{top:30,right:15,bottom:15,left:80},o.clickFunc=o.rotated?t.geneHistogramClick:t.donorHistogramClick,o.width=t.width||500,o.height=t.height||500,o.histogramWidth=o.rotated?o.height:o.width,o.histogramHeight=80,o.numDomain=o.domain.length,o.barWidth=(o.rotated?o.height:o.width)/o.domain.length},o.prototype.render=function(t,e){function r(){for(var t=1,e=0;e<o.domain.length;e++){var r=o.domain[e];t=Math.max(t,r.count)}return t}var o=this;o.x=t,o.div=e;var n=r();o.container=o.svg.append("g").attr("class",o.prefix+"histogram").attr("width",function(){return o.rotated?o.height:o.width+o.margin.left+o.margin.right}).attr("height",o.histogramHeight).style("margin-left",o.margin.left+"px").attr("transform",function(){return o.rotated?"rotate(90)translate(0,-"+o.width+")":""}),o.histogram=o.container.append("g").attr("transform","translate(0,-"+(o.histogramHeight+o.margin.top/1.61803398875)+")"),o.renderAxis(n),o.histogram.selectAll("rect").data(o.domain).enter().append("rect").on("mouseover",function(t){o.div.transition().duration(200).style("opacity",.9),o.div.html(function(){return o.rotated?t.symbol+"<br/> Count:"+t.count+"<br/>":t.id+"<br/> Count:"+t.count+"<br/>"}).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(){o.div.transition().duration(500).style("opacity",0)}).on("click",o.clickFunc).transition().attr("class",function(t){return o.prefix+"sortable-bar "+t.id+"-bar"}).attr("width",o.barWidth-1).attr("height",function(t){return o.histogramHeight*t.count/n}).attr("x",function(t){return o.x(o.getIndex(o.domain,t.id))}).attr("y",function(t){return o.histogramHeight-o.histogramHeight*t.count/n}).attr("fill","#1693C0")},o.prototype.update=function(t,e){var r=this;r.x=e,r.domain=t,r.barWidth=(r.rotated?r.height:r.width)/r.domain.length,r.histogram.selectAll("rect").transition().attr("width",r.barWidth-1).attr("x",function(t){return r.x(r.getIndex(r.domain,t.id))})},o.prototype.resize=function(t,e){var r=this;r.width=t,r.height=e,r.histogramWidth=r.rotated?r.height:r.width,r.container.attr("width",function(){return r.rotated?r.height:r.width+r.margin.left+r.margin.right}).attr("transform",function(){return r.rotated?"rotate(90)translate(0,-"+r.width+")":""}),r.histogram.attr("transform","translate(0,-"+(r.histogramHeight+r.margin.top/1.61803398875)+")"),r.bottomAxis.attr("x2",r.histogramWidth+10)},o.prototype.renderAxis=function(t){var e=this;e.bottomAxis=e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",e.histogramHeight+5).attr("y2",e.histogramHeight+5).attr("x2",e.histogramWidth+10).attr("transform","translate(-5,0)"),e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",0).attr("y2",e.histogramHeight+5).attr("transform","translate(-5,0)"),e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",-6).attr("dy",".32em").attr("text-anchor","end").text(t);var r=parseInt(t/2),o=e.histogramHeight-e.histogramHeight/(t/r);e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",-6).attr("y",o).attr("dy",".32em").attr("text-anchor","end").text(r),e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("dy",".32em").attr("text-anchor","end").attr("transform","rotate(-90)translate("+o/-2+",-25)").text("Mutation freq.")},o.prototype.getIndex=function(t,e){for(var r=0;r<t.length;r++){var o=t[r];if(o.id===e)return r}return-1},o.prototype.destroy=function(){var t=this;t.histogram.remove(),t.container.remove()},e.exports=o},{}],2:[function(t,e,r){"use strict";var o,n=t("./Histogram"),i=t("./Track");o=function(t,e,r){var o=this;o.lookupTable=e,o.updateCallback=r,o.loadParams(t),o.init(),o.donorHistogram=new n(t,o.svg,!1),o.donorTrack=new i(t,o.svg,!1,t.donorTracks,t.donorOpacityFunc,t.donorFillFunc,r),o.donorTrack.init(),o.geneHistogram=new n(t,o.svg,!0),o.geneTrack=new i(t,o.svg,!0,t.geneTracks,t.geneOpacityFunc,t.donorFillFunc,r),o.geneTrack.init()},o.prototype.loadParams=function(t){var e=this;e.prefix=t.prefix||"og-",e.minCellHeight=t.minCellHeight||10,e.donors=t.donors||[],e.genes=t.genes||[],e.observations=t.observations||[],e.element=t.element||"body",e.colorMap=t.colorMap||{missense_variant:"#ff9b6c",frameshift_variant:"#57dba4",stop_gained:"#af57db",start_lost:"#ff2323",stop_lost:"#d3ec00",initiator_codon_variant:"#5abaff"},e.numDonors=e.donors.length,e.numGenes=e.genes.length,e.width=t.width||500,e.height=t.height||500,e.inputWidth=t.width||500,e.inputHeight=t.height||500,e.cellWidth=e.width/e.donors.length,e.cellHeight=e.height/e.genes.length,e.cellHeight<e.minCellHeight&&(e.cellHeight=e.minCellHeight,t.height=e.numGenes*e.minCellHeight,e.height=t.height),e.margin=t.margin||{top:30,right:100,bottom:15,left:80},e.heatMap=t.heatMap,e.histogramHeight=100,e.drawGridLines=!1,e.crosshair=!1,e.gridClick=t.gridClick},o.prototype.init=function(){var t=this;t.div=d3.select(t.element).append("div").attr("class",t.prefix+"tooltip-oncogrid").style("opacity",0),t.svg=d3.select(t.element).append("svg").attr("class",t.prefix+"maingrid-svg").attr("id",t.prefix+"maingrid-svg").attr("width",t.width+t.margin.left+t.margin.right+2*t.histogramHeight).attr("height",t.height+t.margin.top+t.margin.bottom+2*t.histogramHeight).style("margin-left",t.margin.left+"px").append("g").attr("transform","translate("+t.margin.left+","+(t.margin.top+t.histogramHeight)+")"),t.background=t.svg.append("rect").attr("class","background").attr("width",t.width).attr("height",t.height)},o.prototype.render=function(){var t=this;t.computeCoordinates(),t.svg.selectAll("."+t.prefix+"maingrid-svg").data(t.observations).enter().append("rect").on("mouseover",function(e){t.div.transition().duration(200).style("opacity",.9),t.div.html(e.id+"<br/>"+e.geneSymbol+"<br/>"+e.donorId+"<br/>"+e.consequence).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}).on("mouseout",function(e){t.div.transition().duration(500).style("opacity",0)}).on("click",function(e){"undefined"!=typeof t.gridClick&&t.gridClick(e)}).transition().attr("class",function(e){return t.prefix+"sortable-rect "+e.donorId+"-cell "+e.geneId+"-cell"}).attr("cons",function(t){return t.consequence}).attr("x",function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))}).attr("y",function(e){return t.getY(e)}).attr("width",t.cellWidth).attr("height",function(e){return t.getHeight(e)}).attr("fill",function(e){return t.getColor(e)}).attr("opacity",function(e){return t.getOpacity(e)}).attr("stroke-width",2),t.donorHistogram.render(t.x,t.div),t.donorTrack.render(t.x,t.div),t.geneHistogram.render(t.y,t.div),t.geneTrack.render(t.y,t.div),t.defineCrosshairBehaviour()},o.prototype.update=function(){var t=this;t.numDonors!==t.donors.length||t.numGenes!==t.genes.length?(t.numDonors=t.donors.length,t.numGenes=t.genes.length,t.cellWidth=t.width/t.numDonors,t.cellHeight=t.height/t.numGenes,t.computeCoordinates()):t.row.selectAll("text").attr("style",function(){return t.cellHeight<t.minCellHeight?"display: none;":""}),t.row.transition().attr("transform",function(e){return"translate( 0, "+t.y(t.genes.indexOf(e))+")"}),t.svg.selectAll("."+t.prefix+"sortable-rect").transition().attr("width",t.cellWidth).attr("height",function(e){return t.getHeight(e)}).attr("y",function(e){return t.getY(e)}).attr("x",function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))}),t.donorHistogram.update(t.donors,t.x),t.donorTrack.update(t.donors,t.x),t.geneHistogram.update(t.genes,t.y),t.geneTrack.update(t.genes,t.y)},o.prototype.computeCoordinates=function(){var t=this;t.x=d3.scale.ordinal().domain(d3.range(t.donors.length)).rangeBands([0,t.width]),t.cellWidth=t.width/t.donors.length,"undefined"!=typeof t.column&&t.column.remove(),t.column=t.svg.selectAll("."+t.prefix+"donor-column").data(t.donors).enter().append("g").attr("class",t.prefix+"donor-column").attr("donor",function(t){return t.id}).attr("transform",function(e,r){return"translate("+t.x(r)+")rotate(-90)"}),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),t.y=d3.scale.ordinal().domain(d3.range(t.genes.length)).rangeBands([0,t.height]),t.cellHeight=t.height/t.genes.length,"undefined"!=typeof t.row&&t.row.remove(),t.row=t.svg.selectAll("."+t.prefix+"gene-row").data(t.genes).enter().append("g").attr("class",t.prefix+"gene-row").attr("transform",function(e,r){return"translate(0,"+t.y(r)+")"}),t.drawGridLines&&t.row.append("line").attr("x2",t.width),t.row.append("text").attr("class",function(e){return e.id+"-label "+t.prefix+"gene-label "+t.prefix+"label-text-font"}).transition().attr("x",-8).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").attr("style",function(){return t.cellHeight<t.minCellHeight?"display: none;":""}).text(function(e,r){return t.genes[r].symbol}),t.defineRowDragBehaviour()},o.prototype.resize=function(t,e){var r=this;r.width=t,r.height=e,r.cellWidth=r.width/r.numDonors,r.cellHeight=r.height/r.numGenes,r.cellHeight<r.minCellHeight&&(r.cellHeight=r.minCellHeight,r.height=r.numGenes*r.minCellHeight),d3.select(".og-maingrid-svg").attr("width",r.width+r.margin.left+r.margin.right+2*r.histogramHeight).attr("height",r.height+r.margin.top+r.margin.bottom+2*r.histogramHeight),r.background.attr("width",r.width).attr("height",r.height),r.computeCoordinates(),r.donorHistogram.resize(t,r.height),r.donorTrack.resize(t,r.height),r.geneHistogram.resize(t,r.height),r.geneTrack.resize(t,r.height),r.update();var o=r.svg.node().getBBox();r.verticalCross.attr("y2",o.height),r.horizontalCross.attr("x2",o.width)},o.prototype.defineCrosshairBehaviour=function(){var t=this,e=t.svg.node().getBBox();t.verticalCross=t.svg.append("line").attr("class",t.prefix+"vertical-cross").attr("y1",0).attr("y2",e.height).attr("opacity",0),t.horizontalCross=t.svg.append("line").attr("class",t.prefix+"horizontal-cross").attr("x1",0).attr("x2",e.width).attr("opacity",0),t.svg.on("mousedown",function(){t.startSelection(this)}).on("mouseover",function(){if(t.crosshair){d3.event.stopPropagation();var e=d3.mouse(this);"undefined"!=typeof t.selectionRegion&&t.selectionRegion.attr("width",e[0]-t.selectionRegion.attr("x")).attr("height",e[1]-t.selectionRegion.attr("y")),t.verticalCross.attr("x1",e[0]).attr("opacity",1),t.verticalCross.attr("x2",e[0]).attr("opacity",1),t.horizontalCross.attr("y1",e[1]).attr("opacity",1),t.horizontalCross.attr("y2",e[1]).attr("opacity",1);var r=t.rangeToDomain(t.x,e[0]),o=t.rangeToDomain(t.y,e[1]),n="undefined"!=typeof t.donors[r]?"Donor: "+t.donors[r].id+"</br>":"",i="undefined"!=typeof t.genes[o]?"Gene: "+t.genes[o].symbol+"</br>":"";t.div.transition().duration(200).style("opacity",.9),t.div.html(n+i).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}}).on("mousemove",function(){if(t.crosshair){d3.event.stopPropagation();var e=d3.mouse(this);"undefined"!=typeof t.selectionRegion&&t.selectionRegion.attr("width",e[0]-t.selectionRegion.attr("x")).attr("height",e[1]-t.selectionRegion.attr("y")),t.verticalCross.attr("x1",e[0]).attr("opacity",1),t.verticalCross.attr("x2",e[0]).attr("opacity",1),t.horizontalCross.attr("y1",e[1]).attr("opacity",1),t.horizontalCross.attr("y2",e[1]).attr("opacity",1);var r=t.rangeToDomain(t.x,e[0]),o=t.rangeToDomain(t.y,e[1]),n="undefined"!=typeof t.donors[r]?"Donor: "+t.donors[r].id+"</br>":"",i="undefined"!=typeof t.genes[o]?"Gene: "+t.genes[o].symbol+"</br>":"";t.div.transition().style("opacity",.9),t.div.html(n+i).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}}).on("mouseout",function(){t.crosshair&&(d3.event.stopPropagation(),t.div.transition().duration(500).style("opacity",0),t.verticalCross.attr("opacity",0),t.horizontalCross.attr("opacity",0))}).on("mouseup",function(){t.finishSelection()})},o.prototype.startSelection=function(t){var e=this;if(e.crosshair&&"undefined"==typeof e.selectionRegion){d3.event.stopPropagation();var r=d3.mouse(t);e.selectionRegion=e.svg.append("rect").on("mousemove",function(){var r=d3.mouse(t);e.selectionRegion.attr("width",r[0]-e.selectionRegion.attr("x")).attr("height",r[1]-e.selectionRegion.attr("y"))}).attr("x",r[0]).attr("y",r[1]).attr("fill","blue").attr("stroke","black").attr("stroke-width","2").attr("opacity",.2)}},o.prototype.finishSelection=function(){var t=this;if(t.crosshair&&"undefined"!=typeof t.selectionRegion){d3.event.stopPropagation();var e=Number(t.selectionRegion.attr("x")),r=e+Number(t.selectionRegion.attr("width")),o=Number(t.selectionRegion.attr("y")),n=o+Number(t.selectionRegion.attr("height")),i=t.rangeToDomain(t.x,e),a=t.rangeToDomain(t.x,r),s=t.rangeToDomain(t.y,o),d=t.rangeToDomain(t.y,n);t.sliceDonors(i,a),t.sliceGenes(s,d),t.selectionRegion.remove(),delete t.selectionRegion,t.fullscreen||t.resize(t.inputWidth,t.inputHeight),t.updateCallback(!0)}},o.prototype.sliceGenes=function(t,e){for(var r=this,o=0;o<r.genes.length;o++){var n=r.genes[o];(t>o||o>e)&&(d3.selectAll("."+n.id+"-cell").remove(),d3.selectAll("."+n.id+"-bar").remove(),r.genes.splice(o,1),o--,t--,e--)}},o.prototype.sliceDonors=function(t,e){for(var r=this,o=0;o<r.donors.length;o++){var n=r.donors[o];(t>o||o>e)&&(d3.selectAll("."+n.id+"-cell").remove(),d3.selectAll("."+n.id+"-bar").remove(),r.donors.splice(o,1),o--,t--,e--)}},o.prototype.defineRowDragBehaviour=function(){var t=this,e=d3.behavior.drag();e.on("dragstart",function(){d3.event.sourceEvent.stopPropagation()}),e.on("drag",function(e){var r=d3.event.dy,o=t.genes.indexOf(e),n=d3.select(this);n.attr("transform",function(){var t=d3.transform(d3.select(this).attr("transform"));return"translate( 0, "+(parseInt(t.translate[1])+r)+")"});var i=d3.transform(d3.select(this).attr("transform")).translate[1];t.row.each(function(e){var n,a,s=t.genes.indexOf(e);r>0&&s>o?(a=d3.transform(d3.select(this).attr("transform")).translate[1],i>a&&(n=t.genes[o],t.genes[o]=t.genes[s],t.genes[s]=n)):0>r&&o>s&&(a=d3.transform(d3.select(this).attr("transform")).translate[1],a>i&&(n=t.genes[o],t.genes[o]=t.genes[s],t.genes[s]=n))})}),e.on("dragend",function(){t.updateCallback(!0)});var r=t.row.call(e);r.on("click",function(){d3.event.defaultPrevented}),t.row.on("mouseover",function(){var e=this;"undefined"!=typeof e.timeout&&clearTimeout(e.timeout),d3.select(this).select("."+t.prefix+"remove-gene").attr("style","display: block")}),t.row.on("mouseout",function(){var e=this;e.timeout=setTimeout(function(){d3.select(e).select("."+t.prefix+"remove-gene").attr("style","display: none")},500)})},o.prototype.getY=function(t){var e=this,r=e.genes.map(function(t){return t.id});if(e.heatMap===!0)return e.y(r.indexOf(t.geneId));var o=e.lookupTable[t.donorId][t.geneId];return e.y(r.indexOf(t.geneId))+e.cellHeight/o.length*o.indexOf(t.id)},o.prototype.getColor=function(t){var e=this;return e.heatMap===!0?"#D33682":e.colorMap[t.consequence]},o.prototype.getOpacity=function(){var t=this;return t.heatMap===!0?.25:1},o.prototype.getHeight=function(t){var e=this;if("undefined"!=typeof t){if(e.heatMap===!0)return e.cellHeight;var r=e.lookupTable[t.donorId][t.geneId].length;return e.cellHeight/r}return 0},o.prototype.toggleHeatmap=function(){var t=this;t.heatMap=t.heatMap!==!0,d3.selectAll("."+t.prefix+"sortable-rect").transition().attr("y",function(e){return t.getY(e)}).attr("height",function(e){return t.getHeight(e)}).attr("fill",function(e){return t.getColor(e)}).attr("opacity",function(e){return t.getOpacity(e)})},o.prototype.toggleGridLines=function(){var t=this;t.drawGridLines?t.drawGridLines=!1:t.drawGridLines=!0,t.geneTrack.toggleGridLines(),t.donorTrack.toggleGridLines(),t.computeCoordinates()},o.prototype.toggleCrosshair=function(){var t=this;t.crosshair?t.crosshair=!1:t.crosshair=!0},o.prototype.getDonorIndex=function(t,e){for(var r=0;r<t.length;r++){var o=t[r];if(o.id===e)return r}return-1},o.prototype.removeGene=function(t){var e=this,r=e.genes[t];r&&(d3.selectAll("."+r.id+"-cell").remove(),d3.selectAll("."+r.id+"-bar").remove(),e.genes.splice(t,1)),e.updateCallback(!0)},o.prototype.rangeToDomain=function(t,e){return t.domain()[d3.bisect(t.range(),e)-1]},o.prototype.destroy=function(){var t=this;d3.select(t.element).select("."+t.prefix+"maingrid-svg").remove(),d3.select(t.element).select("."+t.prefix+"tooltip-oncogrid").remove()},e.exports=o},{"./Histogram":1,"./Track":4}],3:[function(t,e,r){"use strict";var o,n=t("./MainGrid");o=function(t){var e=this;e.params=t,e.donors=t.donors||[],e.genes=t.genes||[],e.observations=t.observations||[],e.createLookupTable(),e.computeDonorCounts(),e.computeGeneCounts(),e.computeGeneScores(),e.genesSortbyScores(),e.computeScores(),e.sortByScores(),e.mainGrid=new n(t,e.lookupTable,e.update(e)),e.charts=[],e.charts.push(e.mainGrid)},o.prototype.createLookupTable=function(){for(var t=this,e={},r=0;r<t.observations.length;r++){var o=t.observations[r],n=o.donorId,i=o.geneId;e.hasOwnProperty(n)?e[n].hasOwnProperty(i)?e[n][i].push(o.id):e[n][i]=[o.id]:(e[n]={},e[n][i]=[o.id]),t.lookupTable=e}},o.prototype.render=function(){var t=this;t.charts.forEach(function(t){t.render()})},o.prototype.update=function(t){var e=t;return function(t){t="undefined"==typeof t||null===t?!1:t,t&&(e.computeScores(),e.sortByScores()),e.charts.forEach(function(t){t.update()})}},o.prototype.resize=function(t,e,r){var o=this;o.toggleGridLines(),o.fullscreen=r,o.charts.forEach(function(o){o.fullscreen=r,o.resize(Number(t),Number(e))}),o.toggleGridLines()},o.prototype.sortByScores=function(){var t=this;t.donors.sort(t.sortScore)},o.prototype.genesSortbyScores=function(){var t=this;t.genes.sort(t.sortScore)},o.prototype.getDonorIndex=function(t,e){for(var r=0;r<t.length;r++){var o=t[r];if(o.id===e)return r}return-1},o.prototype.cluster=function(){var t=this;t.genesSortbyScores(),t.computeScores(),t.sortByScores(),t.update(t)()},o.prototype.removeDonors=function(t){for(var e=this,r=[],o=0;o<e.donors.length;o++){var n=e.donors[o];t(n)&&(r.push(n.id),d3.selectAll("."+n.id+"-cell").remove(),d3.selectAll("."+n.id+"-bar").remove(),e.donors.splice(o,1),o--)}for(var i=0;i<e.observations.length;i++){var a=e.observations[i];e.donors.indexOf(a.id)>=0&&(e.observations.splice(i,1),i--)}e.computeGeneScores(),e.update(e)()},o.prototype.removeGenes=function(t){for(var e=this,r=[],o=0;o<e.genes.length;o++){var n=e.genes[o];t(n)&&(r.push(n.id),d3.selectAll("."+n.id+"-cell").remove(),d3.selectAll("."+n.id+"-bar").remove(),e.genes.splice(o,1),o--)}e.update(e)()},o.prototype.sortDonors=function(t){var e=this;e.donors.sort(t),e.update(e)()},o.prototype.sortGenes=function(t){var e=this;e.computeScores(),e.sortByScores(),e.genes.sort(t),e.update(e)()},o.prototype.toggleHeatmap=function(){var t=this;t.mainGrid.toggleHeatmap()},o.prototype.toggleGridLines=function(){var t=this;t.mainGrid.toggleGridLines()},o.prototype.toggleCrosshair=function(){var t=this;t.mainGrid.toggleCrosshair()},o.prototype.mutationScore=function(t,e){var r=this;return r.lookupTable.hasOwnProperty(t)&&r.lookupTable[t].hasOwnProperty(e)?1:0},o.prototype.mutationGeneScore=function(t,e){var r=this;return r.lookupTable.hasOwnProperty(t)&&r.lookupTable[t].hasOwnProperty(e)?r.lookupTable[t][e].length:0},o.prototype.computeScores=function(){for(var t=this,e=0;e<t.donors.length;e++){var r=t.donors[e];r.score=0;for(var o=0;o<t.genes.length;o++){var n=t.genes[o];r.score+=t.mutationScore(r.id,n.id)*Math.pow(2,t.genes.length+1-o)}}},o.prototype.computeGeneScores=function(){for(var t=this,e=0;e<t.genes.length;e++){var r=t.genes[e];r.score=0;for(var o=0;o<t.donors.length;o++){var n=t.donors[o];r.score+=t.mutationGeneScore(n.id,r.id)}}},o.prototype.computeDonorCounts=function(){for(var t=this,e=0;e<t.donors.length;e++){var r=t.donors[e];r.count=0;for(var o=0;o<t.observations.length;o++){var n=t.observations[o];r.id===n.donorId&&(r.count+=1)}}},o.prototype.computeGeneCounts=function(){for(var t=this,e=0;e<t.genes.length;e++){var r=t.genes[e];r.count=0;for(var o=0;o<t.observations.length;o++){var n=t.observations[o];r.id===n.geneId&&(r.count+=1)}}},o.prototype.sortScore=function(t,e){return t.score<e.score?1:t.score>e.score?-1:0},o.prototype.destroy=function(){var t=this;t.charts.forEach(function(t){t.destroy()})},e.exports=o},{"./MainGrid":2}],4:[function(t,e,r){"use strict";var o;o=function(t,e,r,o,n,i,a){var s=this;s.prefix=t.prefix||"og-",s.svg=e,s.rotated=r||!1,s.updateCallback=a,s.clickFunc=s.rotated?t.geneClick:t.donorClick,s.margin=t.margin||{top:30,right:15,bottom:15,left:80},s.domain=(s.rotated?t.genes:t.donors)||[],s.width=(s.rotated?t.height:t.width)||500,s.cellHeight=t.trackHeight||20,s.numDomain=s.domain.length,s.cellWidth=s.width/s.numDomain,s.availableTracks=o||[],s.opacityFunc=n,s.fillFunc=i,s.translateDown=(s.rotated?-1*(t.width+150+s.availableTracks.length*s.cellHeight):t.height)||500,s.height=s.cellHeight*s.availableTracks.length,s.drawGridLines=!1},o.prototype.init=function(){var t=this;t.trackData=[];for(var e=0;e<t.domain.length;e++)for(var r=0;r<t.availableTracks.length;r++)t.trackData.push({id:t.domain[e].id,displayId:t.rotated?t.domain[e].symbol:t.domain[e].id,value:t.domain[e][t.availableTracks[r].fieldName],fieldName:t.availableTracks[r].fieldName,type:t.availableTracks[r].type});t.container=t.svg.append("g").attr("width",t.width).attr("height",t.height).attr("class",t.prefix+"track").attr("transform",function(){return t.rotated?"rotate(90)":""}),t.track=t.container.append("g").attr("transform","translate(0,"+(t.translateDown+t.margin.top/1.61803398875)+")"),t.background=t.track.append("rect").attr("class","background").attr("width",t.width).attr("height",t.height)},o.prototype.render=function(t,e){var r=this;r.x=t,r.div=e,r.computeCoordinates(),r.track.selectAll("."+r.prefix+"track").data(r.trackData).enter().append("rect").on("mouseover",function(t){r.div.transition().duration(200).style("opacity",.9),r.div.html(function(){return r.rotated?t.displayId+"<br>"+t.fieldName+": "+t.value:t.id+"<br>"+t.fieldName+": "+t.value}).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}).on("mouseout",function(t){r.div.transition().duration(500).style("opacity",0)}).on("click",function(t){r.clickFunc(t)}).transition().attr("class",function(t){return r.prefix+"track-data "+r.prefix+"track-"+t.fieldName+" "+r.prefix+"track-"+t.value+" "+t.id+"-cell"}).attr("x",function(t){return r.getX(t)}).attr("y",function(t){return r.getY(t)}).attr("width",r.cellWidth).attr("height",r.cellHeight).attr("fill",r.fillFunc).attr("opacity",r.opacityFunc)},o.prototype.resize=function(t,e){var r=this;r.width=r.rotated?e:t,r.cellWidth=r.width/r.numDomain,r.height=r.cellHeight*r.availableTracks.length,r.translateDown=(r.rotated?-1*(t+150+r.availableTracks.length*r.cellHeight):e)||500,r.container.attr("width",r.width).attr("height",r.height),r.track.attr("transform","translate(0,"+(r.translateDown+r.margin.top/1.61803398875)+")"),r.background.attr("width",r.width).attr("height",r.height),r.computeCoordinates()},o.prototype.update=function(t,e){var r=this;r.domain=t,r.x=e,r.domain.length!==r.numDomain&&(r.numDomain=r.domain.length,r.cellWidth=r.width/r.numDomain,r.computeCoordinates()),r.track.selectAll("."+r.prefix+"track-data").transition().attr("x",function(t){return r.getX(t)}).attr("width",r.cellWidth)},o.prototype.getX=function(t){var e=this,r=e.domain.map(function(t){return t.id});return e.x(r.indexOf(t.id))},o.prototype.getY=function(t){var e=this,r=e.availableTracks.map(function(t){return t.fieldName});return e.y(r.indexOf(t.fieldName))},o.prototype.computeCoordinates=function(){var t=this;"undefined"!=typeof t.column&&t.column.remove(),t.column=t.track.selectAll("."+t.prefix+"column").data(t.domain).enter().append("g").attr("class",t.prefix+"column").attr("donor",function(t){return t.id}).attr("transform",function(e,r){return"translate("+t.x(r)+")rotate(-90)"}),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),t.y=d3.scale.ordinal().domain(d3.range(t.availableTracks.length)).rangeBands([0,t.height]),"undefined"!=typeof t.row&&t.row.remove(),t.row=t.track.selectAll("."+t.prefix+"row").data(t.availableTracks).enter().append("g").attr("class",t.prefix+"row").attr("transform",function(e,r){return"translate(0,"+t.y(r)+")"}),t.drawGridLines&&t.row.append("line").attr("x2",t.width),t.row.append("text").attr("class",t.prefix+"track-label "+t.prefix+"label-text-font").on("click",function(e){t.domain.sort(e.sort(e.fieldName)),t.updateCallback(!1)}).transition().attr("x",-6).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").text(function(e,r){return t.availableTracks[r].name})},o.prototype.toggleGridLines=function(){var t=this;t.drawGridLines?t.drawGridLines=!1:t.drawGridLines=!0,t.computeCoordinates()},e.exports=o},{}],5:[function(t,e,r){"use strict";window.OncoGrid=t("./OncoGrid")},{"./OncoGrid":3}]},{},[5]);