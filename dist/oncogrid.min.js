!function t(e,r,n){function o(a,s){if(!r[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);throw new Error("Cannot find module '"+a+"'")}var d=r[a]={exports:{}};e[a][0].call(d.exports,function(t){var r=e[a][1][t];return o(r?r:t)},d,d.exports,t,e,r,n)}return r[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({1:[function(t,e,r){"use strict";var n;n=function(t,e,r){var n=this;n.prefix=t.prefix||"og-",n.observations=t.observations,n.svg=e,n.rotated=r||!1,n.domain=(n.rotated?t.genes:t.donors)||[],n.margin=t.margin||{top:30,right:15,bottom:15,left:80},n.clickFunc=n.rotated?t.geneHistogramClick:t.donorHistogramClick,n.width=t.width||500,n.height=t.height||500,n.histogramWidth=n.rotated?n.height:n.width,n.histogramHeight=80,n.numDomain=n.domain.length,n.barWidth=(n.rotated?n.height:n.width)/n.domain.length},n.prototype.render=function(t,e){function r(){for(var t=1,e=0;e<n.domain.length;e++){var r=n.domain[e];t=Math.max(t,r.count)}return t}var n=this;n.x=t,n.div=e;var o=r();n.container=n.svg.append("g").attr("class",n.prefix+"histogram").attr("width",function(){return n.rotated?n.height:n.width+n.margin.left+n.margin.right}).attr("height",n.histogramHeight).style("margin-left",n.margin.left+"px").attr("transform",function(){return n.rotated?"rotate(90)translate(0,-"+n.width+")":""}),n.histogram=n.container.append("g").attr("transform","translate(0,-"+(n.histogramHeight+n.margin.top/1.61803398875)+")"),n.renderAxis(o),n.histogram.selectAll("rect").data(n.domain).enter().append("rect").on("mouseover",function(t){n.div.transition().duration(200).style("opacity",.9),n.div.html(function(){return n.rotated?t.symbol+"<br/> Count:"+t.count+"<br/>":t.id+"<br/> Count:"+t.count+"<br/>"}).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(){n.div.transition().duration(500).style("opacity",0)}).on("click",n.clickFunc).attr("class",function(t){return n.prefix+"sortable-bar "+t.id+"-bar"}).attr("width",n.barWidth-(n.barWidth<3?0:1)).attr("height",function(t){return n.histogramHeight*t.count/o}).attr("x",function(t){return n.x(n.getIndex(n.domain,t.id))}).attr("y",function(t){return n.histogramHeight-n.histogramHeight*t.count/o}).attr("fill","#1693C0")},n.prototype.update=function(t,e){var r=this;r.x=e,r.domain=t,r.barWidth=(r.rotated?r.height:r.width)/r.domain.length,r.histogram.selectAll("rect").transition().attr("width",r.barWidth-(r.barWidth<3?0:1)).attr("x",function(t){return r.x(r.getIndex(r.domain,t.id))})},n.prototype.resize=function(t,e){var r=this;r.width=t,r.height=e,r.histogramWidth=r.rotated?r.height:r.width,r.container.attr("width",function(){return r.rotated?r.height:r.width+r.margin.left+r.margin.right}).attr("transform",function(){return r.rotated?"rotate(90)translate(0,-"+r.width+")":""}),r.histogram.attr("transform","translate(0,-"+(r.histogramHeight+r.margin.top/1.61803398875)+")"),r.bottomAxis.attr("x2",r.histogramWidth+10)},n.prototype.renderAxis=function(t){var e=this;e.bottomAxis=e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",e.histogramHeight+5).attr("y2",e.histogramHeight+5).attr("x2",e.histogramWidth+10).attr("transform","translate(-5,0)"),e.histogram.append("line").attr("class",e.prefix+"histogram-axis").attr("y1",0).attr("y2",e.histogramHeight+5).attr("transform","translate(-5,0)"),e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",-6).attr("dy",".32em").attr("text-anchor","end").text(t);var r=parseInt(t/2),n=e.histogramHeight-e.histogramHeight/(t/r);e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("x",-6).attr("y",n).attr("dy",".32em").attr("text-anchor","end").text(r),e.histogram.append("text").attr("class",e.prefix+"label-text-font").attr("dy",".32em").attr("text-anchor","end").attr("transform","rotate(-90)translate("+n/-2+",-25)").text("Mutation freq.")},n.prototype.getIndex=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return r}return-1},n.prototype.destroy=function(){var t=this;t.histogram.remove(),t.container.remove()},e.exports=n},{}],2:[function(t,e,r){"use strict";var n,o=t("./Histogram"),i=t("./Track");n=function(t,e,r){var n=this;n.lookupTable=e,n.updateCallback=r,n.loadParams(t),n.init(),n.donorHistogram=new o(t,n.svg,!1),n.donorTrack=new i(t,n.svg,!1,t.donorTracks,t.donorOpacityFunc,t.donorFillFunc,r),n.donorTrack.init(),n.geneHistogram=new o(t,n.svg,!0),n.geneTrack=new i(t,n.svg,!0,t.geneTracks,t.geneOpacityFunc,t.donorFillFunc,r),n.geneTrack.init()},n.prototype.loadParams=function(t){var e=this;e.prefix=t.prefix||"og-",e.minCellHeight=t.minCellHeight||10,e.donors=t.donors||[],e.genes=t.genes||[],e.observations=t.observations||[],e.element=t.element||"body",e.colorMap=t.colorMap||{missense_variant:"#ff9b6c",frameshift_variant:"#57dba4",stop_gained:"#af57db",start_lost:"#ff2323",stop_lost:"#d3ec00",initiator_codon_variant:"#5abaff"},e.numDonors=e.donors.length,e.numGenes=e.genes.length,e.width=t.width||500,e.height=t.height||500,e.inputWidth=t.width||500,e.inputHeight=t.height||500,e.cellWidth=e.width/e.donors.length,e.cellHeight=e.height/e.genes.length,e.cellHeight<e.minCellHeight&&(e.cellHeight=e.minCellHeight,t.height=e.numGenes*e.minCellHeight,e.height=t.height),e.margin=t.margin||{top:30,right:100,bottom:15,left:80},e.heatMap=t.heatMap,e.histogramHeight=100,e.drawGridLines=t.grid||!1,e.crosshair=!1,e.gridClick=t.gridClick},n.prototype.init=function(){var t=this;t.div=d3.select(t.element).append("div").attr("class",t.prefix+"tooltip-oncogrid").style("opacity",0),t.svg=d3.select(t.element).append("svg").attr("class",t.prefix+"maingrid-svg").attr("id",t.prefix+"maingrid-svg").attr("width",t.width+t.margin.left+t.margin.right+2*t.histogramHeight).attr("height",t.height+t.margin.top+t.margin.bottom+2*t.histogramHeight).style("margin-left",t.margin.left+"px").append("g").attr("transform","translate("+t.margin.left+","+(t.margin.top+t.histogramHeight)+")"),t.background=t.svg.append("rect").attr("class","background").attr("width",t.width).attr("height",t.height)},n.prototype.render=function(){var t=this;t.computeCoordinates(),t.svg.selectAll("."+t.prefix+"maingrid-svg").data(t.observations).enter().append("rect").on("mouseover",function(e){t.div.transition().duration(200).style("opacity",.9),t.div.html(e.id+"<br/>"+e.geneSymbol+"<br/>"+e.donorId+"<br/>"+e.consequence).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}).on("mouseout",function(){t.div.transition().duration(500).style("opacity",0)}).on("click",function(e){"undefined"!=typeof t.gridClick&&t.gridClick(e)}).attr("class",function(e){return t.prefix+"sortable-rect "+e.donorId+"-cell "+e.geneId+"-cell"}).attr("cons",function(t){return t.consequence}).attr("x",function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))}).attr("y",function(e){return t.getY(e)}).attr("width",t.cellWidth).attr("height",function(e){return t.getHeight(e)}).attr("fill",function(e){return t.getColor(e)}).attr("opacity",function(e){return t.getOpacity(e)}).attr("stroke-width",2),t.donorHistogram.render(t.x,t.div),t.donorTrack.render(t.x,t.div),t.geneHistogram.render(t.y,t.div),t.geneTrack.render(t.y,t.div),t.defineCrosshairBehaviour()},n.prototype.update=function(){var t=this;t.numDonors!==t.donors.length||t.numGenes!==t.genes.length?(t.numDonors=t.donors.length,t.numGenes=t.genes.length,t.cellWidth=t.width/t.numDonors,t.cellHeight=t.height/t.numGenes,t.computeCoordinates()):t.row.selectAll("text").attr("style",function(){return t.cellHeight<t.minCellHeight?"display: none;":""}),t.row.transition().attr("transform",function(e){return"translate( 0, "+t.y(t.genes.indexOf(e))+")"}),t.svg.selectAll("."+t.prefix+"sortable-rect").transition().attr("width",t.cellWidth).attr("height",function(e){return t.getHeight(e)}).attr("y",function(e){return t.getY(e)}).attr("x",function(e){return t.x(t.getDonorIndex(t.donors,e.donorId))}),t.donorHistogram.update(t.donors,t.x),t.donorTrack.update(t.donors,t.x),t.geneHistogram.update(t.genes,t.y),t.geneTrack.update(t.genes,t.y)},n.prototype.computeCoordinates=function(){var t=this;t.x=d3.scale.ordinal().domain(d3.range(t.donors.length)).rangeBands([0,t.width]),t.cellWidth=t.width/t.donors.length,"undefined"!=typeof t.column&&t.column.remove(),t.column=t.svg.selectAll("."+t.prefix+"donor-column").data(t.donors).enter().append("g").attr("class",t.prefix+"donor-column").attr("donor",function(t){return t.id}).attr("transform",function(e,r){return"translate("+t.x(r)+")rotate(-90)"}),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),t.y=d3.scale.ordinal().domain(d3.range(t.genes.length)).rangeBands([0,t.height]),t.cellHeight=t.height/t.genes.length,"undefined"!=typeof t.row&&t.row.remove(),t.row=t.svg.selectAll("."+t.prefix+"gene-row").data(t.genes).enter().append("g").attr("class",t.prefix+"gene-row").attr("transform",function(e,r){return"translate(0,"+t.y(r)+")"}),t.drawGridLines&&t.row.append("line").attr("x2",t.width),t.row.append("text").attr("class",function(e){return e.id+"-label "+t.prefix+"gene-label "+t.prefix+"label-text-font"}).attr("x",-8).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").attr("style",function(){return t.cellHeight<t.minCellHeight?"display: none;":""}).text(function(e,r){return t.genes[r].symbol}),t.defineRowDragBehaviour()},n.prototype.resize=function(t,e){var r=this;r.width=t,r.height=e,r.cellWidth=r.width/r.donors.length,r.cellHeight=r.height/r.genes.length,r.cellHeight<r.minCellHeight&&(r.cellHeight=r.minCellHeight,r.height=r.genes.length*r.minCellHeight),d3.select(".og-maingrid-svg").attr("width",r.width+r.margin.left+r.margin.right+2*r.histogramHeight).attr("height",r.height+r.margin.top+r.margin.bottom+2*r.histogramHeight),r.background.attr("width",r.width).attr("height",r.height),r.computeCoordinates(),r.donorHistogram.resize(t,r.height),r.donorTrack.resize(t,r.height,r.x),r.geneHistogram.resize(t,r.height),r.geneTrack.resize(t,r.height,r.y),r.update();var n=r.svg.node().getBBox();r.verticalCross.attr("y2",n.height),r.horizontalCross.attr("x2",n.width)},n.prototype.defineCrosshairBehaviour=function(){var t=this;t.verticalCross=t.svg.append("line").attr("class",t.prefix+"vertical-cross").attr("y1",-t.histogramHeight).attr("y2",t.height+t.donorTrack.height).attr("opacity",0),t.horizontalCross=t.svg.append("line").attr("class",t.prefix+"horizontal-cross").attr("x1",0).attr("x2",t.width+t.histogramHeight+t.geneTrack.height).attr("opacity",0),t.svg.on("mousedown",function(){t.startSelection(this)}).on("mouseover",function(){if(t.crosshair){d3.event.stopPropagation();var e=d3.mouse(this);"undefined"!=typeof t.selectionRegion&&t.selectionRegion.attr("width",e[0]-t.selectionRegion.attr("x")).attr("height",e[1]-t.selectionRegion.attr("y")),t.verticalCross.attr("x1",e[0]).attr("opacity",1),t.verticalCross.attr("x2",e[0]).attr("opacity",1),t.horizontalCross.attr("y1",e[1]).attr("opacity",1),t.horizontalCross.attr("y2",e[1]).attr("opacity",1);var r=t.rangeToDomain(t.x,e[0]),n=t.rangeToDomain(t.y,e[1]),o="undefined"!=typeof t.donors[r]&&e[0]<=t.width?"Donor: "+t.donors[r].id+"</br>":"",i="undefined"!=typeof t.genes[n]&&e[1]<=t.height?"Gene: "+t.genes[n].symbol+"</br>":"";t.div.transition().duration(200).style("opacity",.9),t.div.html(o+i).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}}).on("mousemove",function(){if(t.crosshair){d3.event.stopPropagation();var e=d3.mouse(this);"undefined"!=typeof t.selectionRegion&&t.selectionRegion.attr("width",e[0]-t.selectionRegion.attr("x")).attr("height",e[1]-t.selectionRegion.attr("y")),t.verticalCross.attr("x1",e[0]).attr("opacity",1),t.verticalCross.attr("x2",e[0]).attr("opacity",1),t.horizontalCross.attr("y1",e[1]).attr("opacity",1),t.horizontalCross.attr("y2",e[1]).attr("opacity",1);var r=t.rangeToDomain(t.x,e[0]),n=t.rangeToDomain(t.y,e[1]),o="undefined"!=typeof t.donors[r]&&e[0]<=t.width?"Donor: "+t.donors[r].id+"</br>":"",i="undefined"!=typeof t.genes[n]&&e[1]<=t.height?"Gene: "+t.genes[n].symbol+"</br>":"";t.div.transition().style("opacity",.9),t.div.html(o+i).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}}).on("mouseout",function(){t.crosshair&&(d3.event.stopPropagation(),t.div.transition().duration(500).style("opacity",0),t.verticalCross.attr("opacity",0),t.horizontalCross.attr("opacity",0))}).on("mouseup",function(){t.finishSelection()})},n.prototype.startSelection=function(t){var e=this;if(e.crosshair&&"undefined"==typeof e.selectionRegion){d3.event.stopPropagation();var r=d3.mouse(t);e.selectionRegion=e.svg.append("rect").on("mousemove",function(){var r=d3.mouse(t);e.selectionRegion.attr("width",r[0]-e.selectionRegion.attr("x")).attr("height",r[1]-e.selectionRegion.attr("y"))}).attr("x",r[0]).attr("y",r[1]).attr("class",e.prefix+"selection-region").attr("stroke","black").attr("stroke-width","2").attr("opacity",.2)}},n.prototype.finishSelection=function(){var t=this;if(t.crosshair&&"undefined"!=typeof t.selectionRegion){d3.event.stopPropagation();var e=Number(t.selectionRegion.attr("x")),r=e+Number(t.selectionRegion.attr("width")),n=Number(t.selectionRegion.attr("y")),o=n+Number(t.selectionRegion.attr("height")),i=t.rangeToDomain(t.x,e),a=t.rangeToDomain(t.x,r),s=t.rangeToDomain(t.y,n),l=t.rangeToDomain(t.y,o);t.sliceDonors(i,a),t.sliceGenes(s,l),t.selectionRegion.remove(),delete t.selectionRegion,t.fullscreen||t.resize(t.inputWidth,t.inputHeight),t.updateCallback(!0)}},n.prototype.sliceGenes=function(t,e){for(var r=this,n=0;n<r.genes.length;n++){var o=r.genes[n];(t>n||n>e)&&(d3.selectAll("."+o.id+"-cell").remove(),d3.selectAll("."+o.id+"-bar").remove(),r.genes.splice(n,1),n--,t--,e--)}},n.prototype.sliceDonors=function(t,e){for(var r=this,n=0;n<r.donors.length;n++){var o=r.donors[n];(t>n||n>e)&&(d3.selectAll("."+o.id+"-cell").remove(),d3.selectAll("."+o.id+"-bar").remove(),r.donors.splice(n,1),n--,t--,e--)}},n.prototype.defineRowDragBehaviour=function(){var t=this,e=d3.behavior.drag();e.on("dragstart",function(){d3.event.sourceEvent.stopPropagation()}),e.on("drag",function(){var t=d3.event.dy,e=d3.select(this);e.attr("transform",function(){var e=d3.transform(d3.select(this).attr("transform"));return"translate( 0, "+(parseInt(e.translate[1])+t)+")"})}),e.on("dragend",function(e){var r=d3.mouse(t.svg.node()),n=t.genes.indexOf(e),o=t.rangeToDomain(t.y,r[1]);t.genes.splice(n,1),t.genes.splice(o,0,e),t.updateCallback(!0)});var r=t.row.call(e);r.on("click",function(){d3.event.defaultPrevented}),t.row.on("mouseover",function(){var e=this;"undefined"!=typeof e.timeout&&clearTimeout(e.timeout),d3.select(this).select("."+t.prefix+"remove-gene").attr("style","display: block")}),t.row.on("mouseout",function(){var e=this;e.timeout=setTimeout(function(){d3.select(e).select("."+t.prefix+"remove-gene").attr("style","display: none")},500)})},n.prototype.getY=function(t){var e=this,r=e.genes.map(function(t){return t.id});if(e.heatMap===!0)return e.y(r.indexOf(t.geneId));var n=e.lookupTable[t.donorId][t.geneId];return e.y(r.indexOf(t.geneId))+e.cellHeight/n.length*n.indexOf(t.id)},n.prototype.getColor=function(t){var e=this;return e.heatMap===!0?"#D33682":e.colorMap[t.consequence]},n.prototype.getOpacity=function(){var t=this;return t.heatMap===!0?.25:1},n.prototype.getHeight=function(t){var e=this;if("undefined"!=typeof t){if(e.heatMap===!0)return e.cellHeight;var r=e.lookupTable[t.donorId][t.geneId].length;return e.cellHeight/r}return 0},n.prototype.toggleHeatmap=function(){var t=this;t.heatMap=t.heatMap!==!0,d3.selectAll("."+t.prefix+"sortable-rect").transition().attr("y",function(e){return t.getY(e)}).attr("height",function(e){return t.getHeight(e)}).attr("fill",function(e){return t.getColor(e)}).attr("opacity",function(e){return t.getOpacity(e)})},n.prototype.toggleGridLines=function(){var t=this;t.drawGridLines=!t.drawGridLines,t.geneTrack.toggleGridLines(),t.donorTrack.toggleGridLines(),t.computeCoordinates()},n.prototype.toggleCrosshair=function(){var t=this;t.crosshair=!t.crosshair},n.prototype.getDonorIndex=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return r}return-1},n.prototype.removeGene=function(t){var e=this,r=e.genes[t];r&&(d3.selectAll("."+r.id+"-cell").remove(),d3.selectAll("."+r.id+"-bar").remove(),e.genes.splice(t,1)),e.updateCallback(!0)},n.prototype.rangeToDomain=function(t,e){return t.domain()[d3.bisect(t.range(),e)-1]},n.prototype.destroy=function(){var t=this;d3.select(t.element).select("."+t.prefix+"maingrid-svg").remove(),d3.select(t.element).select("."+t.prefix+"tooltip-oncogrid").remove()},e.exports=n},{"./Histogram":1,"./Track":4}],3:[function(t,e,r){"use strict";var n,o=t("./MainGrid");n=function(t){var e=this;e.params=t,e.donors=t.donors||[],e.genes=t.genes||[],e.observations=t.observations||[],e.inputWidth=t.width||500,e.inputHeight=t.height||500,e.createLookupTable(),e.computeDonorCounts(),e.computeGeneCounts(),e.computeGeneScores(),e.genesSortbyScores(),e.computeScores(),e.sortByScores(),e.mainGrid=new o(t,e.lookupTable,e.update(e)),e.charts=[],e.charts.push(e.mainGrid)},n.prototype.createLookupTable=function(){for(var t=this,e={},r=0;r<t.observations.length;r++){var n=t.observations[r],o=n.donorId,i=n.geneId;e.hasOwnProperty(o)?e[o].hasOwnProperty(i)?e[o][i].push(n.id):e[o][i]=[n.id]:(e[o]={},e[o][i]=[n.id]),t.lookupTable=e}},n.prototype.render=function(){var t=this;setTimeout(function(){t.charts.forEach(function(t){t.render()})})},n.prototype.update=function(t){var e=t;return function(t){t="undefined"==typeof t||null===t?!1:t,t&&(e.computeScores(),e.sortByScores()),e.charts.forEach(function(t){t.update()})}},n.prototype.resize=function(t,e,r){var n=this;n.fullscreen=r,n.charts.forEach(function(n){n.fullscreen=r,n.resize(Number(t),Number(e))})},n.prototype.sortByScores=function(){var t=this;t.donors.sort(t.sortScore)},n.prototype.genesSortbyScores=function(){var t=this;t.genes.sort(t.sortScore)},n.prototype.getDonorIndex=function(t,e){for(var r=0;r<t.length;r++){var n=t[r];if(n.id===e)return r}return-1},n.prototype.cluster=function(){var t=this;t.genesSortbyScores(),t.computeScores(),t.sortByScores(),t.update(t)()},n.prototype.removeDonors=function(t){for(var e=this,r=[],n=0;n<e.donors.length;n++){var o=e.donors[n];t(o)&&(r.push(o.id),d3.selectAll("."+o.id+"-cell").remove(),d3.selectAll("."+o.id+"-bar").remove(),e.donors.splice(n,1),n--)}for(var i=0;i<e.observations.length;i++){var a=e.observations[i];e.donors.indexOf(a.id)>=0&&(e.observations.splice(i,1),i--)}e.computeGeneScores(),e.update(e)(),e.resize(e.inputWidth,e.inputHeight,!1)},n.prototype.removeGenes=function(t){for(var e=this,r=[],n=0;n<e.genes.length;n++){var o=e.genes[n];t(o)&&(r.push(o.id),d3.selectAll("."+o.id+"-cell").remove(),d3.selectAll("."+o.id+"-bar").remove(),e.genes.splice(n,1),n--)}e.update(e)(),e.resize(e.inputWidth,e.inputHeight,!1)},n.prototype.sortDonors=function(t){var e=this;e.donors.sort(t),e.update(e)()},n.prototype.sortGenes=function(t){var e=this;e.computeScores(),e.sortByScores(),e.genes.sort(t),e.update(e)()},n.prototype.toggleHeatmap=function(){var t=this;t.mainGrid.toggleHeatmap()},n.prototype.toggleGridLines=function(){var t=this;t.mainGrid.toggleGridLines()},n.prototype.toggleCrosshair=function(){var t=this;t.mainGrid.toggleCrosshair()},n.prototype.mutationScore=function(t,e){var r=this;return r.lookupTable.hasOwnProperty(t)&&r.lookupTable[t].hasOwnProperty(e)?1:0},n.prototype.mutationGeneScore=function(t,e){var r=this;return r.lookupTable.hasOwnProperty(t)&&r.lookupTable[t].hasOwnProperty(e)?r.lookupTable[t][e].length:0},n.prototype.computeScores=function(){for(var t=this,e=0;e<t.donors.length;e++){var r=t.donors[e];r.score=0;for(var n=0;n<t.genes.length;n++){var o=t.genes[n];r.score+=t.mutationScore(r.id,o.id)*Math.pow(2,t.genes.length+1-n)}}},n.prototype.computeGeneScores=function(){for(var t=this,e=0;e<t.genes.length;e++){var r=t.genes[e];r.score=0;for(var n=0;n<t.donors.length;n++){var o=t.donors[n];r.score+=t.mutationGeneScore(o.id,r.id)}}},n.prototype.computeDonorCounts=function(){for(var t=this,e=0;e<t.donors.length;e++){var r=t.donors[e];r.count=0;for(var n=0;n<t.observations.length;n++){var o=t.observations[n];r.id===o.donorId&&(r.count+=1)}}},n.prototype.computeGeneCounts=function(){for(var t=this,e=0;e<t.genes.length;e++){var r=t.genes[e];r.count=0;for(var n=0;n<t.observations.length;n++){var o=t.observations[n];r.id===o.geneId&&(r.count+=1)}}},n.prototype.sortScore=function(t,e){return t.score<e.score?1:t.score>e.score?-1:t.id>=e.id?1:-1},n.prototype.destroy=function(){var t=this;t.charts.forEach(function(t){t.destroy()})},e.exports=n},{"./MainGrid":2}],4:[function(t,e,r){"use strict";var n,o=t("./TrackGroup");n=function(t,e,r,n,o,i,a){var s=this;s.params=t,s.prefix=t.prefix||"og-",s.svg=e,s.rotated=r||!1,s.updateCallback=a,s.trackLegends=t.trackLegends||{},s.clickFunc=s.rotated?t.geneClick:t.donorClick,s.margin=t.margin||{top:30,right:15,bottom:15,left:80},s.domain=(s.rotated?t.genes:t.donors)||[],s.width=(s.rotated?t.height:t.width)||500,s.cellHeight=t.trackHeight||10,s.numDomain=s.domain.length,s.cellWidth=s.width/s.numDomain,s.availableTracks=n||[],s.opacityFunc=o,s.fillFunc=i,s.drawGridLines=t.grid||!1,s.nullSentinel=t.nullSentinel||-777,s.parseGroups(),s.translateDown=(s.rotated?-1*(t.width+150+s.availableTracks.length*s.cellHeight):t.height)||500},n.prototype.parseGroups=function(){var t=this;t.groupMap={},t.groups=[],t.availableTracks.forEach(function(e){var r=e.group||"Tracks";if(t.groupMap.hasOwnProperty(r))t.groupMap[r].addTrack(e);else{var n=new o({cellHeight:t.cellHeight,width:t.width,clickFunc:t.clickFunc,grid:t.drawGridLines,nullSentinel:t.nullSentinel,domain:t.domain,trackLegend:t.trackLegends[r]||""},r,t.rotated,t.opacityFunc,t.fillFunc,t.updateCallback);n.addTrack(e),t.groupMap[r]=n,t.groups.push(n)}})},n.prototype.init=function(){var t=this;t.trackData=[];for(var e=0;e<t.domain.length;e++)for(var r=0;r<t.availableTracks.length;r++)t.trackData.push({id:t.domain[e].id,displayId:t.rotated?t.domain[e].symbol:t.domain[e].id,value:t.domain[e][t.availableTracks[r].fieldName],fieldName:t.availableTracks[r].fieldName,type:t.availableTracks[r].type});t.height=0;for(var n in t.groupMap)if(t.groupMap.hasOwnProperty(n)){var o=t.groupMap[n];t.height+=o.height+25}t.container=t.svg.append("g").attr("width",t.width).attr("height",t.height).attr("class",t.prefix+"track").attr("transform",function(){return t.rotated?"rotate(90)translate(0,"+(t.translateDown+t.margin.top/1.61803398875)+")":"translate(0,"+(t.translateDown+t.margin.top/1.61803398875)+")"});for(var i=0,a=0;a<t.groups.length;a++){var s=t.groups[a],l=t.container.append("g").attr("transform","translate(0,"+i+")");s.init(l),i+=Number(s.height)+25}},n.prototype.render=function(t,e){for(var r=this,n=0;n<r.groups.length;n++){var o=r.groups[n];o.render(t,e)}},n.prototype.resize=function(t,e,r){var n=this;n.width=n.rotated?e:t,n.height=n.cellHeight*n.availableTracks.length+25*n.availableTracks.length,n.translateDown=(n.rotated?-1*(t+150+n.availableTracks.length*n.cellHeight):e)||500,n.container.attr("width",n.width).attr("height",n.height).attr("transform",function(){return n.rotated?"rotate(90)translate(0,"+(n.translateDown+n.margin.top/1.61803398875)+")":"translate(0,"+(n.translateDown+n.margin.top/1.61803398875)+")"});for(var o=0,i=0;i<n.groups.length;i++){var a=n.groups[i];a.container.attr("transform","translate(0,"+o+")"),o+=Number(a.height)+25,a.resize(n.width,r)}},n.prototype.update=function(t,e){var r=this;r.domain=t,r.x=e;for(var n=0;n<r.groups.length;n++){var o=r.groups[n];o.update(t,e)}},n.prototype.toggleGridLines=function(){for(var t=this,e=0;e<t.groups.length;e++){var r=t.groups[e];r.toggleGridLines()}},e.exports=n},{"./TrackGroup":5}],5:[function(t,e,r){"use strict";var n;n=function(t,e,r,n,o,i){var a=this;a.prefix=t.prefix||"og-",a.name=e,a.cellHeight=t.cellHeight||20,a.height=0,a.width=t.width,a.tracks=[],a.length=0,a.nullSentinel=t.nullSentinel||-777,a.rotated=r,a.updateCallback=i,a.trackLegend=t.trackLegend,a.clickFunc=t.clickFunc,a.opacityFunc=n,a.fillFunc=o,a.drawGridLines=t.grid||!1,a.domain=t.domain,a.trackData=[]},n.prototype.addTrack=function(t){var e=this;e.length=e.tracks.push(t),e.height+=e.cellHeight},n.prototype.refreshData=function(){for(var t=this,e=0;e<t.domain.length;e++)for(var r=0;r<t.tracks.length;r++)t.trackData.push({id:t.domain[e].id,displayId:t.rotated?t.domain[e].symbol:t.domain[e].id,value:t.domain[e][t.tracks[r].fieldName],displayName:t.tracks[r].name,fieldName:t.tracks[r].fieldName,type:t.tracks[r].type})},n.prototype.init=function(t){var e=this;e.container=t,e.label=e.container.append("text").attr("x",-6).attr("y",-7).attr("dy",".32em").attr("text-anchor","end").attr("class",e.prefix+"track-group-label").text(e.name),e.background=e.container.append("rect").attr("class","background").attr("width",e.width).attr("height",e.height),e.refreshData()},n.prototype.render=function(t,e){var r=this;r.x=t,r.div=e,r.computeCoordinates(),r.cellWidth=r.width/r.domain.length,setTimeout(function(){r.container.selectAll("."+r.prefix+"track").data(r.trackData).enter().append("rect").on("mouseover",function(t){r.div.transition().duration(200).style("opacity",.9),r.div.html(function(){return r.rotated?t.displayId+"<br>"+t.displayName+": "+(t.value===r.nullSentinel?"Not Verified":t.value):t.id+"<br>"+t.displayName+": "+(t.value===r.nullSentinel?"Not Verified":t.value)}).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}).on("mouseout",function(){r.div.transition().duration(500).style("opacity",0)}).on("click",function(t){r.clickFunc(t)}).attr("class",function(t){return r.prefix+"track-data "+r.prefix+"track-"+t.fieldName+" "+r.prefix+"track-"+t.value+" "+t.id+"-cell"}).attr("x",function(t){return r.getX(t)}).attr("y",function(t){return r.getY(t)}).attr("width",r.cellWidth).attr("height",r.cellHeight).attr("fill",r.fillFunc).attr("opacity",r.opacityFunc)}),r.label.on("mouseover",function(){r.div.transition().duration(200).style("opacity",.9),r.div.html(function(){return r.trackLegend}).style("left",d3.event.pageX+15+"px").style("top",d3.event.pageY+30+"px")}).on("mouseout",function(){r.div.transition().duration(500).style("opacity",0)})},n.prototype.update=function(t,e){var r=this;r.domain=t,r.x=e,r.domain.length!==r.numDomain&&(r.numDomain=r.domain.length,r.cellWidth=r.width/r.numDomain,r.computeCoordinates()),r.container.selectAll("."+r.prefix+"track-data").transition().attr("x",function(t){return r.getX(t)}).attr("width",r.cellWidth)},n.prototype.resize=function(t,e){var r=this;r.width=t,r.x=e,r.height=r.cellHeight*r.tracks.length,r.cellWidth=r.width/r.domain.length,r.background.attr("class","background").attr("width",r.width).attr("height",r.height),r.computeCoordinates()},n.prototype.computeCoordinates=function(){var t=this;"undefined"!=typeof t.column&&t.column.remove(),t.column=t.container.selectAll("."+t.prefix+"column").data(t.domain).enter().append("g").attr("class",t.prefix+"column").attr("donor",function(t){return t.id}).attr("transform",function(e,r){return"translate("+t.x(r)+")rotate(-90)"}),t.drawGridLines&&t.column.append("line").attr("x1",-t.height),t.y=d3.scale.ordinal().domain(d3.range(t.tracks.length)).rangeBands([0,t.height]),"undefined"!=typeof t.row&&t.row.remove(),t.row=t.container.selectAll("."+t.prefix+"row").data(t.tracks).enter().append("g").attr("class",t.prefix+"row").attr("transform",function(e,r){return"translate(0,"+t.y(r)+")"}),t.drawGridLines&&t.row.append("line").attr("x2",t.width),t.row.append("text").attr("class",t.prefix+"track-label "+t.prefix+"label-text-font").on("click",function(e){t.domain.sort(e.sort(e.fieldName)),t.updateCallback(!1)}).transition().attr("x",-6).attr("y",t.cellHeight/2).attr("dy",".32em").attr("text-anchor","end").text(function(e,r){return t.tracks[r].name})},n.prototype.getX=function(t){var e=this,r=e.domain.map(function(t){return t.id});return e.x(r.indexOf(t.id))},n.prototype.getY=function(t){var e=this,r=e.tracks.map(function(t){return t.fieldName});return e.y(r.indexOf(t.fieldName))},n.prototype.toggleGridLines=function(){var t=this;t.drawGridLines=!t.drawGridLines,t.computeCoordinates()},e.exports=n},{}],6:[function(t,e,r){"use strict";window.OncoGrid=t("./OncoGrid")},{"./OncoGrid":3}]},{},[6]);